# This pipeline is used to create a daily sales summary materialized view
# Pipeline variable puts the generate files in the same folder for the pipeline to pick up
pipeline: acmi_edw_gold
# Flowgroup are conceptual artifacts and has no functional purpose
# there are used to group actions together in the generated files
flowgroup: revenue_by_region_mv

actions:

  - name: revenue_by_region_mv_sql
    type: load
    source:
      type: sql
      sql_path: "sql/gld/revenue_by_region_mv.sql"
    target: v_revenue_by_region_mv_sql
    

  - name: write_revenue_by_region_mv
    type: write
    source: v_revenue_by_region_mv_sql
    write_target:
      type: materialized_view
      database: "{catalog}.{gold_schema}"
      table: "revenue_by_region_mv"

    